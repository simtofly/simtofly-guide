# 1.2 Environment Setup

## What You'll Learn

Prepare your Ubuntu system for drone development:

- Update system to latest packages
- Install essential development tools
- Create organized workspace structure  
- Verify everything is ready for ArduPilot SITL

**Time:** 15-20 minutes

---

## Prerequisites

Before starting, you must have completed:

- âœ… [1.1 Prerequisites and Setup](1.1-prerequisites.md)
- âœ… Ubuntu 22.04 LTS installed and booted
- âœ… Internet connection working
- âœ… System meets minimum requirements

---

## ğŸ“„ Update Your System

### Why Update First?

Before installing anything, ensure your system has:
- Latest security patches
- Updated package repositories
- Bug fixes and improvements

**This prevents compatibility issues later.**

---

### Update Commands

Open terminal (Ctrl+Alt+T) and run:
```bash
sudo apt update
```

**What this does:** Updates the list of available packages and versions.

**Expected output:**
```
Hit:1 http://archive.ubuntu.com/ubuntu jammy InRelease
Get:2 http://archive.ubuntu.com/ubuntu jammy-updates InRelease [119 kB]
...
Reading package lists... Done
```

âœ… **Success:** No errors, shows "Reading package lists... Done"

---

Now upgrade installed packages:
```bash
sudo apt upgrade -y
```

**What this does:** Downloads and installs updates.

**This takes:** 5-15 minutes depending on pending updates.

**Expected output:**
```
Reading package lists... Done
Building dependency tree... Done
...
The following packages will be upgraded:
  [list of packages]
...
Setting up [package names]...
```

âœ… **Success:** Completes without errors

---

### Clean Up

Remove unnecessary packages:
```bash
sudo apt autoremove -y
sudo apt autoclean
```

**What this does:** Frees disk space by removing unused packages.

---

### Reboot (Important!)
```bash
sudo reboot
```

**Why reboot?** Kernel updates require restart to take effect.

**After reboot:** Open terminal again and continue.

---

## ğŸ› ï¸ Install Essential Development Tools

### Install Required Packages

ArduPilot and ROS2 need these tools:
```bash
sudo apt install -y \
    build-essential \
    git \
    python3 \
    python3-pip \
    python3-dev \
    curl \
    wget \
    nano \
    net-tools \
    tree
```

**What these are:**
- `build-essential` â€” C/C++ compiler (for building ArduPilot)
- `git` â€” Version control (to clone ArduPilot)
- `python3` â€” Python runtime (ArduPilot SITL uses Python)
- `python3-pip` â€” Python package installer
- `python3-dev` â€” Python development headers
- `curl`, `wget` â€” Download files from internet
- `nano` â€” Simple text editor
- `net-tools` â€” Network diagnostics
- `tree` â€” Directory structure visualization

**This takes:** 2-5 minutes

**Expected output:**
```
Reading package lists... Done
Building dependency tree... Done
...
Setting up build-essential...
Setting up git...
...
```

âœ… **Success:** All packages installed without errors

---

### Verify Installation
```bash
gcc --version
git --version
python3 --version
pip3 --version
tree --version
```

**Expected output:**

![Verify Installation](../../docs/phase-1-simulation/images/1.2_verify_install.png)

```
gcc (Ubuntu 11.x.x) ...
git version 2.34.x
Python 3.10.x
pip 22.x.x from ...
tree v1.8.x
```

âœ… **Success:** All tools show version numbers

---

## ğŸ“ Create Workspace Structure

### Why Organized Workspace?

Having a clear structure prevents:
- Files scattered everywhere
- Forgetting where you saved things
- Conflicts between different projects

All SimToFly work will be in one place: `~/simtofly_ws/`

---

### Create Main Workspace
```bash
mkdir -p ~/simtofly_ws
cd ~/simtofly_ws
```

**What this creates:** Main folder for all SimToFly work.

---

### Create Subdirectories
```bash
mkdir -p logs missions scripts ros2_ws
```

**What each folder is for:**
- `logs/` â€” Flight logs and telemetry data
- `missions/` â€” Mission files and waypoints
- `scripts/` â€” Helper scripts and tools
- `ros2_ws/` â€” ROS2 workspace (Phase 2)

**Note:** We'll create the `ardupilot/` folder in Section 1.3 when we clone ArduPilot repository.

---

### Verify Structure
```bash
tree -L 1 ~/simtofly_ws
```

**Expected output:**

![Verify Structure Output](../../docs/phase-1-simulation/images/1.2_ws.png)

```
/home/your-username/simtofly_ws
â”œâ”€â”€ logs
â”œâ”€â”€ missions
â”œâ”€â”€ ros2_ws
â””â”€â”€ scripts

4 directories, 0 files
```

âœ… **Success:** Four directories created

---

### Add Workspace Environment Variable

Make it easy to access workspace from anywhere:
```bash
echo 'export SIMTOFLY_WS=~/simtofly_ws' >> ~/.bashrc
source ~/.bashrc
```

**What this does:** Creates a shortcut variable to your workspace.

---

### Test Workspace Variable
```bash
echo $SIMTOFLY_WS
cd $SIMTOFLY_WS
pwd
```

**Expected output:**

![Test Workspace Variable](../../docs/phase-1-simulation/images/1.2_ws_path.png)

```
/home/your-username/simtofly_ws
```

âœ… **Success:** Can access workspace via `$SIMTOFLY_WS`

---

## ğŸ§ª System Check and Verification

### Create Verification Script

Let's create a script to check everything is ready:
```bash
nano ~/simtofly_ws/scripts/check_environment.sh
```

**Paste this script:**
```bash
#!/bin/bash

echo "=========================================="
echo "SimToFly Environment Check"
echo "=========================================="
echo ""

# Check Ubuntu version
echo "Checking Ubuntu version..."
if lsb_release -d | grep -q "22.04"; then
    echo "âœ… Ubuntu 22.04 detected"
else
    echo "âŒ Wrong Ubuntu version. Need 22.04"
    lsb_release -d
fi
echo ""

# Check disk space
echo "Checking disk space..."
AVAILABLE=$(df -BG / | tail -1 | awk '{print $4}' | sed 's/G//')
if [ "$AVAILABLE" -gt 30 ]; then
    echo "âœ… Sufficient disk space: ${AVAILABLE}GB available"
else
    echo "âš ï¸ Low disk space: ${AVAILABLE}GB available (need 30GB+)"
fi
echo ""

# Check RAM
echo "Checking RAM..."
TOTAL_RAM=$(free -g | awk '/^Mem:/{print $2}')
if [ "$TOTAL_RAM" -ge 7 ]; then
    echo "âœ… Sufficient RAM: ${TOTAL_RAM}GB"
else
    echo "âš ï¸ Low RAM: ${TOTAL_RAM}GB (recommended 8GB+)"
fi
echo ""

# Check essential tools
echo "Checking essential tools..."
TOOLS=("gcc" "g++" "make" "git" "python3" "pip3" "tree")
for tool in "${TOOLS[@]}"; do
    if command -v $tool &> /dev/null; then
        echo "âœ… $tool installed"
    else
        echo "âŒ $tool NOT installed"
    fi
done
echo ""

# Check workspace structure
echo "Checking workspace structure..."
DIRS=("logs" "missions" "scripts" "ros2_ws")
for dir in "${DIRS[@]}"; do
    if [ -d "$HOME/simtofly_ws/$dir" ]; then
        echo "âœ… $dir directory exists"
    else
        echo "âŒ $dir directory missing"
    fi
done
echo ""

# Check internet
echo "Checking internet connection..."
if ping -c 1 google.com &> /dev/null; then
    echo "âœ… Internet connection working"
else
    echo "âŒ No internet connection"
fi
echo ""

echo "=========================================="
echo "Environment check complete!"
echo "=========================================="
```

**Save and exit:** Ctrl+X, then Y, then Enter

---

### Make Script Executable
```bash
chmod +x ~/simtofly_ws/scripts/check_environment.sh
```

---

### Run Verification
```bash
~/simtofly_ws/scripts/check_environment.sh
```

**Expected output:**

![Run Verification](../../docs/phase-1-simulation/images/1.2_env_check.png)

```
==========================================
SimToFly Environment Check
==========================================

Checking Ubuntu version...
âœ… Ubuntu 22.04 detected

Checking disk space...
âœ… Sufficient disk space: 45GB available

Checking RAM...
âœ… Sufficient RAM: 8GB

Checking essential tools...
âœ… gcc installed
âœ… g++ installed
âœ… make installed
âœ… git installed
âœ… python3 installed
âœ… pip3 installed
âœ… tree installed

Checking workspace structure...
âœ… logs directory exists
âœ… missions directory exists
âœ… scripts directory exists
âœ… ros2_ws directory exists

Checking internet connection...
âœ… Internet connection working

==========================================
Environment check complete!
==========================================
```

âœ… **All checks pass:** Your environment is ready!

âš ï¸ **Some checks fail:** Review and fix issues before continuing.

---

## ğŸ“‹ Final Checklist

Before moving to next section, verify:

- [ ] âœ… System fully updated (`apt update && upgrade`)
- [ ] âœ… Rebooted after updates
- [ ] âœ… Essential tools installed (gcc, git, python3, tree)
- [ ] âœ… Workspace structure created (`~/simtofly_ws/`)
- [ ] âœ… Verification script runs successfully
- [ ] âœ… All checks in verification script pass

**All checked?** You're ready for ArduPilot SITL! ğŸš€

---

## ğŸ¯ What You Accomplished

- âœ… Updated Ubuntu to latest packages
- âœ… Installed development tools (gcc, git, python3)
- âœ… Created organized workspace structure
- âœ… Set up workspace environment variable
- âœ… Created verification script for future checks
- âœ… Verified environment is ready

**Your system is now ready for ArduPilot SITL installation!**

---

## ğŸš€ Next Steps

Continue to **[1.3 ArduPilot SITL Installation](1.3-ardupilot-sitl.md)** where we'll:
- Clone ArduPilot source code
- Install ArduPilot dependencies
- Build SITL simulator
- Launch your first virtual drone
- Test basic commands

---

## â“ Common Questions

### Q: Do I need to run the verification script every time?

**A:** No, just once now to confirm setup. Run it again only if something breaks later.

---

### Q: Can I use a different workspace location?

**A:** Yes, but stick with `~/simtofly_ws/` for consistency with this tutorial. If you change it, you'll need to adapt all commands.

---

### Q: The update took very long, is this normal?

**A:** Yes, first update after fresh Ubuntu install can take 15-30 minutes depending on internet speed and pending updates.

---

### Q: I got errors during `apt upgrade`, what do I do?

**A:** Read the error message carefully. Common fixes:
- Run `sudo apt --fix-broken install`
- Try `sudo dpkg --configure -a`
- Reboot and try again
- Search the specific error online

---

### Q: Why don't we create the ardupilot folder here?

**A:** We'll clone ArduPilot directly in Section 1.3, which automatically creates the `ardupilot/` directory. Creating it now would cause confusion with nested paths.

---

## ğŸ› Troubleshooting

### "Unable to locate package" errors

**Cause:** Package repositories not updated

**Solution:**
```bash
sudo apt update
sudo apt install -y [package-name]
```

---

### "Permission denied" when creating directories

**Cause:** Trying to create in protected location

**Solution:** Make sure you're creating in your home directory (`~/`), not system directories like `/opt/` or `/usr/`.

---

### Verification script shows "command not found"

**Cause:** Script doesn't have execute permission

**Solution:**
```bash
chmod +x ~/simtofly_ws/scripts/check_environment.sh
```

---

### Terminal changes don't apply

**Cause:** Didn't reload bashrc

**Solution:**
```bash
source ~/.bashrc
```

Or close and reopen terminal.

---

### Some packages fail to install

**Cause:** Broken dependencies or repository issues

**Solution:**
```bash
sudo apt --fix-broken install
sudo apt update
sudo apt install -y [package-names]
```

---

[â† Back: 1.1 Prerequisites](1.1-prerequisites.md) | [Next: 1.3 ArduPilot SITL â†’](1.3-ardupilot-sitl.md)