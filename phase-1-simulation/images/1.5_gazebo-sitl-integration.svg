<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 520">
  <defs>
    <linearGradient id="sitlGrad3" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3182ce"/>
      <stop offset="100%" style="stop-color:#2b6cb0"/>
    </linearGradient>
    <linearGradient id="gazeboGrad3" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ed8936"/>
      <stop offset="100%" style="stop-color:#dd6b20"/>
    </linearGradient>
    <linearGradient id="pluginGrad3" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#805ad5"/>
      <stop offset="100%" style="stop-color:#6b46c1"/>
    </linearGradient>
    <linearGradient id="termGrad3" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2d3748"/>
      <stop offset="100%" style="stop-color:#1a202c"/>
    </linearGradient>
    <filter id="shadow7" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="1" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
    <marker id="arrowBlue3" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3182ce"/>
    </marker>
    <marker id="arrowOrange3" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ed8936"/>
    </marker>
    <marker id="arrowPurple3" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#805ad5"/>
    </marker>
    <marker id="arrowGray3" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#718096"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="520" fill="#f7fafc"/>
  
  <!-- Title -->
  <text x="450" y="30" font-family="Segoe UI, Arial, sans-serif" font-size="18" font-weight="600" fill="#2d3748" text-anchor="middle">Gazebo + SITL Integration</text>
  <text x="450" y="48" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="#718096" text-anchor="middle">How ArduPilot Gazebo Plugin connects simulation to flight controller</text>
  
  <!-- Terminal 1 Box -->
  <rect x="30" y="70" width="180" height="80" rx="6" fill="url(#termGrad3)" filter="url(#shadow7)"/>
  <circle cx="45" cy="85" r="5" fill="#fc8181"/>
  <circle cx="60" cy="85" r="5" fill="#f6e05e"/>
  <circle cx="75" cy="85" r="5" fill="#68d391"/>
  <text x="120" y="85" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#a0aec0" text-anchor="middle">Terminal 1</text>
  <text x="120" y="110" font-family="Consolas, monospace" font-size="9" fill="#68d391" text-anchor="middle">gz sim -v4 -r</text>
  <text x="120" y="125" font-family="Consolas, monospace" font-size="9" fill="#68d391" text-anchor="middle">iris_runway.sdf</text>
  <text x="120" y="142" font-family="Segoe UI, Arial, sans-serif" font-size="8" fill="#a0aec0" text-anchor="middle">Start Gazebo first</text>
  
  <!-- Terminal 2 Box -->
  <rect x="30" y="170" width="180" height="80" rx="6" fill="url(#termGrad3)" filter="url(#shadow7)"/>
  <circle cx="45" cy="185" r="5" fill="#fc8181"/>
  <circle cx="60" cy="185" r="5" fill="#f6e05e"/>
  <circle cx="75" cy="185" r="5" fill="#68d391"/>
  <text x="120" y="185" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#a0aec0" text-anchor="middle">Terminal 2</text>
  <text x="120" y="210" font-family="Consolas, monospace" font-size="8" fill="#68d391" text-anchor="middle">sim_vehicle.py</text>
  <text x="120" y="223" font-family="Consolas, monospace" font-size="8" fill="#68d391" text-anchor="middle">-f gazebo-iris</text>
  <text x="120" y="236" font-family="Consolas, monospace" font-size="8" fill="#68d391" text-anchor="middle">--model JSON</text>
  <text x="120" y="248" font-family="Segoe UI, Arial, sans-serif" font-size="8" fill="#a0aec0" text-anchor="middle">Then start SITL</text>
  
  <!-- Arrow from Terminal 1 to Gazebo -->
  <path d="M 210 110 L 280 110 L 280 160" stroke="#718096" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arrowGray3)"/>
  
  <!-- Arrow from Terminal 2 to SITL -->
  <path d="M 210 210 L 280 210 L 280 290" stroke="#718096" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arrowGray3)"/>
  
  <!-- Main SITL Box -->
  <rect x="250" y="290" width="200" height="180" rx="10" fill="#ffffff" stroke="#3182ce" stroke-width="3" filter="url(#shadow7)"/>
  <rect x="250" y="290" width="200" height="40" rx="10" fill="url(#sitlGrad3)"/>
  <rect x="250" y="322" width="200" height="8" fill="url(#sitlGrad3)"/>
  <text x="350" y="316" font-family="Segoe UI, Arial, sans-serif" font-size="13" font-weight="600" fill="#ffffff" text-anchor="middle">ArduPilot SITL</text>
  
  <!-- SITL internals -->
  <text x="270" y="355" font-family="Segoe UI, Arial, sans-serif" font-size="10" font-weight="600" fill="#2d3748">Flight Controller Logic:</text>
  <text x="280" y="375" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• Attitude control (PID)</text>
  <text x="280" y="390" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• Navigation algorithms</text>
  <text x="280" y="405" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• Flight mode logic</text>
  <text x="280" y="420" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• Motor mixing</text>
  
  <rect x="265" y="435" width="170" height="25" rx="4" fill="#ebf8ff"/>
  <text x="350" y="452" font-family="Consolas, monospace" font-size="9" fill="#2b6cb0" text-anchor="middle">JSON Interface Port</text>
  
  <!-- Main Gazebo Box -->
  <rect x="550" y="100" width="200" height="180" rx="10" fill="#ffffff" stroke="#ed8936" stroke-width="3" filter="url(#shadow7)"/>
  <rect x="550" y="100" width="200" height="40" rx="10" fill="url(#gazeboGrad3)"/>
  <rect x="550" y="132" width="200" height="8" fill="url(#gazeboGrad3)"/>
  <text x="650" y="126" font-family="Segoe UI, Arial, sans-serif" font-size="13" font-weight="600" fill="#ffffff" text-anchor="middle">Gazebo Harmonic</text>
  
  <!-- Gazebo internals -->
  <text x="570" y="165" font-family="Segoe UI, Arial, sans-serif" font-size="10" font-weight="600" fill="#2d3748">Physics Simulation:</text>
  <text x="580" y="185" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• 3D visualization</text>
  <text x="580" y="200" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• Rigid body dynamics</text>
  <text x="580" y="215" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• Collision detection</text>
  <text x="580" y="230" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• Sensor models</text>
  
  <rect x="565" y="245" width="170" height="25" rx="4" fill="#feebc8"/>
  <text x="650" y="262" font-family="Consolas, monospace" font-size="9" fill="#c05621" text-anchor="middle">ArduPilotPlugin loaded</text>
  
  <!-- ArduPilot Gazebo Plugin Box (center bridge) -->
  <rect x="480" y="320" width="180" height="150" rx="10" fill="#ffffff" stroke="#805ad5" stroke-width="3" filter="url(#shadow7)"/>
  <rect x="480" y="320" width="180" height="35" rx="10" fill="url(#pluginGrad3)"/>
  <rect x="480" y="348" width="180" height="7" fill="url(#pluginGrad3)"/>
  <text x="570" y="343" font-family="Segoe UI, Arial, sans-serif" font-size="11" font-weight="600" fill="#ffffff" text-anchor="middle">ArduPilot Plugin</text>
  
  <!-- Plugin internals -->
  <text x="500" y="380" font-family="Segoe UI, Arial, sans-serif" font-size="9" font-weight="600" fill="#2d3748">Bridge Functions:</text>
  <text x="510" y="398" font-family="Segoe UI, Arial, sans-serif" font-size="8" fill="#4a5568">• Receives motor commands</text>
  <text x="510" y="412" font-family="Segoe UI, Arial, sans-serif" font-size="8" fill="#4a5568">• Sends sensor data</text>
  <text x="510" y="426" font-family="Segoe UI, Arial, sans-serif" font-size="8" fill="#4a5568">• Synchronizes time</text>
  <text x="510" y="440" font-family="Segoe UI, Arial, sans-serif" font-size="8" fill="#4a5568">• JSON ↔ Gazebo translation</text>
  
  <rect x="495" y="450" width="150" height="15" rx="3" fill="#e9d8fd"/>
  <text x="570" y="461" font-family="Consolas, monospace" font-size="8" fill="#6b46c1" text-anchor="middle">libArduPilotPlugin.so</text>
  
  <!-- Data Flow Arrows -->
  
  <!-- SITL to Plugin: Motor Commands -->
  <path d="M 450 400 L 480 400" stroke="#3182ce" stroke-width="3" marker-end="url(#arrowBlue3)"/>
  <rect x="395" y="378" width="55" height="30" rx="3" fill="#ebf8ff" stroke="#bee3f8" stroke-width="1"/>
  <text x="422" y="391" font-family="Segoe UI, Arial, sans-serif" font-size="7" fill="#2b6cb0" text-anchor="middle">Motor</text>
  <text x="422" y="401" font-family="Segoe UI, Arial, sans-serif" font-size="7" fill="#2b6cb0" text-anchor="middle">Commands</text>
  
  <!-- Plugin to SITL: Sensor Data -->
  <path d="M 480 430 L 450 430" stroke="#ed8936" stroke-width="3" marker-end="url(#arrowOrange3)"/>
  <rect x="395" y="418" width="55" height="30" rx="3" fill="#feebc8" stroke="#fbd38d" stroke-width="1"/>
  <text x="422" y="431" font-family="Segoe UI, Arial, sans-serif" font-size="7" fill="#c05621" text-anchor="middle">Sensor</text>
  <text x="422" y="441" font-family="Segoe UI, Arial, sans-serif" font-size="7" fill="#c05621" text-anchor="middle">Data</text>
  
  <!-- Plugin to Gazebo: Apply Forces -->
  <path d="M 620 320 L 620 280" stroke="#805ad5" stroke-width="3" marker-end="url(#arrowPurple3)"/>
  <rect x="625" y="285" width="55" height="30" rx="3" fill="#e9d8fd" stroke="#d6bcfa" stroke-width="1"/>
  <text x="652" y="298" font-family="Segoe UI, Arial, sans-serif" font-size="7" fill="#6b46c1" text-anchor="middle">Apply</text>
  <text x="652" y="308" font-family="Segoe UI, Arial, sans-serif" font-size="7" fill="#6b46c1" text-anchor="middle">Forces</text>
  
  <!-- Gazebo to Plugin: Physics State -->
  <path d="M 580 280 L 540 320" stroke="#ed8936" stroke-width="3" marker-end="url(#arrowOrange3)"/>
  <rect x="520" y="285" width="55" height="30" rx="3" fill="#feebc8" stroke="#fbd38d" stroke-width="1"/>
  <text x="547" y="298" font-family="Segoe UI, Arial, sans-serif" font-size="7" fill="#c05621" text-anchor="middle">Physics</text>
  <text x="547" y="308" font-family="Segoe UI, Arial, sans-serif" font-size="7" fill="#c05621" text-anchor="middle">State</text>
  
  <!-- Data Flow Legend Box -->
  <rect x="700" y="320" width="180" height="180" rx="8" fill="#ffffff" stroke="#e2e8f0" stroke-width="2" filter="url(#shadow7)"/>
  <text x="790" y="345" font-family="Segoe UI, Arial, sans-serif" font-size="11" font-weight="600" fill="#2d3748" text-anchor="middle">Data Flow</text>
  <line x1="715" y1="355" x2="865" y2="355" stroke="#e2e8f0" stroke-width="1"/>
  
  <!-- Legend items -->
  <line x1="720" y1="380" x2="755" y2="380" stroke="#3182ce" stroke-width="3" marker-end="url(#arrowBlue3)"/>
  <text x="770" y="384" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">Motor PWM</text>
  <text x="770" y="396" font-family="Segoe UI, Arial, sans-serif" font-size="8" fill="#718096">(SITL → Plugin)</text>
  
  <line x1="720" y1="420" x2="755" y2="420" stroke="#ed8936" stroke-width="3" marker-end="url(#arrowOrange3)"/>
  <text x="770" y="424" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">Sensor Data</text>
  <text x="770" y="436" font-family="Segoe UI, Arial, sans-serif" font-size="8" fill="#718096">(GPS, IMU, Baro)</text>
  
  <line x1="720" y1="460" x2="755" y2="460" stroke="#805ad5" stroke-width="3" marker-end="url(#arrowPurple3)"/>
  <text x="770" y="464" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">Physics Forces</text>
  <text x="770" y="476" font-family="Segoe UI, Arial, sans-serif" font-size="8" fill="#718096">(Thrust, Torque)</text>
  
  <!-- Sensor list box -->
  <rect x="760" y="100" width="120" height="130" rx="6" fill="#ffffff" stroke="#e2e8f0" stroke-width="1" filter="url(#shadow7)"/>
  <text x="820" y="120" font-family="Segoe UI, Arial, sans-serif" font-size="10" font-weight="600" fill="#2d3748" text-anchor="middle">Simulated Sensors</text>
  <line x1="770" y1="130" x2="870" y2="130" stroke="#e2e8f0" stroke-width="1"/>
  <text x="780" y="148" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• GPS position</text>
  <text x="780" y="163" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• IMU (accel/gyro)</text>
  <text x="780" y="178" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• Barometer</text>
  <text x="780" y="193" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• Magnetometer</text>
  <text x="780" y="208" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#4a5568">• Rangefinder</text>
  <text x="780" y="223" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#718096">• Camera (optional)</text>
  
  <!-- Connection to sensor box -->
  <path d="M 750 190 L 760 190" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="3,2"/>
  
  <!-- Footer note -->
  <text x="450" y="505" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#a0aec0" text-anchor="middle">The plugin runs inside Gazebo and communicates with SITL via JSON protocol over localhost</text>
</svg>
